{"version":3,"file":"script.js","sources":["src/grid-controller.js","src/settings-form.js","src/index.js"],"sourcesContent":["import { Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nexport class GridController\n{\n\tgrid: BX.Main.Grid;\n\n\tconstructor(options)\n\t{\n\t\tthis.grid = BX.Main.gridManager.getInstanceById(options.gridId);\n\n\t\tthis.initGrid();\n\t}\n\n\tgetGridBodyRows(): Array\n\t{\n\t\treturn this.grid.getRows().getBodyChild();\n\t}\n\n\tinitGrid(): void\n\t{\n\t\tEventEmitter.subscribe('Grid::updated', (event) => {\n\t\t\tconst grid = event.getCompatData()[0];\n\t\t\tif (grid && grid.getId() === this.grid.getId())\n\t\t\t{\n\t\t\t\tconst delayToExitStream = 10;\n\t\t\t\tsetTimeout(this.initGridRows.bind(this), delayToExitStream);\n\t\t\t}\n\t\t});\n\n\t\tthis.initGridRows();\n\t}\n\n\tinitGridRows(): void\n\t{\n\t\tconst bodyRows = this.getGridBodyRows();\n\t\tif (bodyRows.length === 0)\n\t\t{\n\t\t\tfor (let i = 0; i < 5; i++)\n\t\t\t{\n\t\t\t\tthis.prependRowEditor();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tbodyRows.forEach((row) => {\n\t\t\t\trow.edit();\n\t\t\t});\n\t\t}\n\t}\n\n\tprependRowEditor()\n\t{\n\t\tconst newRow = this.grid.prependRowEditor();\n\t\tnewRow.setId('');\n\t\tnewRow.unselect();\n\t}\n\n\tremoveGridSelectedRows()\n\t{\n\t\tconst rows = this.grid.getRows().getSelected(false);\n\t\tif (Type.isArray(rows))\n\t\t{\n\t\t\trows.forEach((row) => {\n\t\t\t\trow.hide();\n\t\t\t});\n\n\t\t\tthis.grid.getRows().reset();\n\t\t}\n\t}\n}\n","import { Loc, Type, Uri } from 'main.core';\nimport { Menu, MenuManager } from 'main.popup';\nimport { BitrixVue } from 'ui.vue3';\nimport { GridController } from './grid-controller';\n\nexport class SettingsForm\n{\n\tgridController: GridController;\n\tdirectoryItems: Array;\n\tnewDirectoryValue = '-1';\n\tselectedDirectory: String;\n\tapp: BitrixVue;\n\n\tstatic createApp(gridController: GridController, options): SettingsForm\n\t{\n\t\tconst form = new SettingsForm(gridController, options);\n\n\t\tform.app = BitrixVue.createApp(form.getAppConfig());\n\t\tform.app.mount(options.settingsFormSelector);\n\n\t\treturn form;\n\t}\n\n\tconstructor(gridController: GridController, options)\n\t{\n\t\tthis.gridController = gridController;\n\t\tthis.directoryItems = Type.isArray(options.directoryItems) ? options.directoryItems : [];\n\n\t\tthis.selectedDirectory = this.newDirectoryValue;\n\t\tif (options.selectedDirectory)\n\t\t{\n\t\t\tconst selectedItem = this.directoryItems.find((item) => item.VALUE === options.selectedDirectory);\n\t\t\tif (selectedItem)\n\t\t\t{\n\t\t\t\tthis.selectedDirectory = selectedItem.VALUE;\n\t\t\t}\n\t\t}\n\t}\n\n\treloadDirectory(directoryTableName): never\n\t{\n\t\tconst url = new Uri(location.href);\n\t\turl.setQueryParam('directoryTableName', directoryTableName);\n\t\tlocation.href = url.toString();\n\t}\n\n\tgetAppConfig()\n\t{\n\t\tconst form = this;\n\n\t\treturn (function() {\n\t\t\treturn {\n\t\t\t\tdata()\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdirectoryName: null,\n\t\t\t\t\t\tdirectoryValue: form.selectedDirectory,\n\t\t\t\t\t\tdirectoryItems: form.directoryItems,\n\t\t\t\t\t};\n\t\t\t\t},\n\n\t\t\t\tcomputed: {\n\t\t\t\t\tselectedDirectoryName()\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.isNewDirectory)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn Loc.getMessage('IBLOCK_PROPERTY_TYPE_DIRECTORY_SETTINGS_NEW_DIRECTORY_NAME');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn this.directoryItemsMap[this.directoryValue];\n\t\t\t\t\t},\n\n\t\t\t\t\tdirectoryItemsMap()\n\t\t\t\t\t{\n\t\t\t\t\t\tconst result = {};\n\n\t\t\t\t\t\tthis.directoryItems.forEach((item) => {\n\t\t\t\t\t\t\tresult[item.VALUE] = item.NAME;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t},\n\n\t\t\t\t\tdirectoryItemsFull()\n\t\t\t\t\t{\n\t\t\t\t\t\tconst result = [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tNAME: Loc.getMessage('IBLOCK_PROPERTY_TYPE_DIRECTORY_SETTINGS_NEW_DIRECTORY_NAME'),\n\t\t\t\t\t\t\t\tVALUE: form.newDirectoryValue,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t];\n\n\t\t\t\t\t\tresult.push(...this.directoryItems);\n\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t},\n\n\t\t\t\t\tdirectoryItemsAsMenuItems()\n\t\t\t\t\t{\n\t\t\t\t\t\treturn this.directoryItemsFull.map((item) => {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tid: item.VALUE,\n\t\t\t\t\t\t\t\ttext: item.NAME,\n\t\t\t\t\t\t\t\tonclick: this.onSelectDirectoryItem.bind(this),\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\n\t\t\t\t\tisNewDirectory()\n\t\t\t\t\t{\n\t\t\t\t\t\treturn this.directoryValue === form.newDirectoryValue;\n\t\t\t\t\t},\n\t\t\t\t},\n\n\t\t\t\tmethods: {\n\t\t\t\t\tgetDirectoryDropdownMenu(bindElement: Element|null): Menu\n\t\t\t\t\t{\n\t\t\t\t\t\tconst menuId = 'directory-items';\n\t\t\t\t\t\tlet menu = MenuManager.getMenuById(menuId);\n\n\t\t\t\t\t\t// destroy menu if binded element destroyed\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tmenu\n\t\t\t\t\t\t\t&& bindElement\n\t\t\t\t\t\t\t&& menu.getPopupWindow().bindElement !== bindElement\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tMenuManager.destroy(menu.getId());\n\t\t\t\t\t\t\tmenu = null;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!menu && bindElement)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenu = MenuManager.create({\n\t\t\t\t\t\t\t\tid: menuId,\n\t\t\t\t\t\t\t\titems: this.directoryItemsAsMenuItems,\n\t\t\t\t\t\t\t\tbindElement,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn menu;\n\t\t\t\t\t},\n\n\t\t\t\t\ttoggleDirectoryDropdown(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getDirectoryDropdownMenu(e.target).toggle();\n\t\t\t\t\t},\n\n\t\t\t\t\tonSelectDirectoryItem(e, item)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.directoryValue = item.id;\n\t\t\t\t\t\tthis.getDirectoryDropdownMenu().close();\n\n\t\t\t\t\t\tform.reloadDirectory(this.directoryValue);\n\t\t\t\t\t},\n\n\t\t\t\t\tnormalizeName(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst input = e.target;\n\t\t\t\t\t\tif (input)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tinput.value = BX.translit(\n\t\t\t\t\t\t\t\tinput.value,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t'change_case': 'L',\n\t\t\t\t\t\t\t\t\t'replace_space': '',\n\t\t\t\t\t\t\t\t\t'delete_repeat_replace': true,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\n\t\t\t\t\taddNewRow()\n\t\t\t\t\t{\n\t\t\t\t\t\tform.gridController.prependRowEditor();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t})();\n\t}\n}\n","import { ajax } from \"main.core\";\nimport { Alert, AlertColor } from \"ui.alerts\";\nimport { GridController } from \"./grid-controller\";\nimport { SettingsForm } from \"./settings-form\";\n\nexport class PropertyDirectorySettings\n{\n\tgridController: GridController;\n\tsettingsForm: SettingsForm;\n\tsignedParameters: String;\n\terrorAlert: Alert;\n\n\tconstructor(options)\n\t{\n\t\tthis.gridController = new GridController(options);\n\t\tthis.signedParameters = options.signedParameters;\n\t\tthis.settingsForm = SettingsForm.createApp(this.gridController, options);\n\n\t\tthis.initErrorAlert();\n\t\tthis.initSaveButton();\n\t}\n\n\tremoveGridSelectedRows()\n\t{\n\t\tthis.gridController.removeGridSelectedRows();\n\t}\n\n\tinitSaveButton(): void\n\t{\n\t\tconst button = document.querySelector('#ui-button-panel-save');\n\t\tif (button)\n\t\t{\n\t\t\tbutton.addEventListener('click', async (e) => {\n\t\t\t\te.preventDefault();\n\n\t\t\t\tawait this.clearErrors();\n\n\t\t\t\tajax\n\t\t\t\t\t.runComponentAction('bitrix:iblock.property.type.directory.settings', 'save', {\n\t\t\t\t\t\tdata: this.getFormData(),\n\t\t\t\t\t\tmode: 'class',\n\t\t\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\t\t})\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tbutton.classList.remove('ui-btn-wait');\n\n\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t})\n\t\t\t\t\t.catch((response) => {\n\t\t\t\t\t\tbutton.classList.remove('ui-btn-wait');\n\n\t\t\t\t\t\tthis.showErrors(response.errors);\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t});\n\t\t}\n\t}\n\n\tclearErrors(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst animateClosingDelay = 300;\n\n\t\t\tthis.errorAlert.hide();\n\n\t\t\tsetTimeout(resolve, animateClosingDelay);\n\t\t});\n\t}\n\n\tshowErrors(errors)\n\t{\n\t\tthis.errorAlert.setText(errors.map((i) => i.message).join('<br>'));\n\t\tthis.errorAlert.renderTo(document.querySelector('#ui-button-panel'));\n\t}\n\n\tinitErrorAlert(): Alert\n\t{\n\t\tthis.errorAlert = new Alert({\n\t\t\tcolor: AlertColor.DANGER,\n\t\t\tanimated: true,\n\t\t\tcustomClass: 'iblock-property-type-directory-settings-errors-container',\n\t\t});\n\t}\n\n\tgetFormData(): FormData\n\t{\n\t\tconst result = new FormData();\n\n\t\tresult.append('fields[DIRECTORY_NAME]', this.settingsForm.app._instance.data.directoryName || '');\n\t\tresult.append('fields[DIRECTORY_TABLE_NAME]', this.settingsForm.app._instance.data.directoryValue || '');\n\n\t\tlet newRowsCount = 0;\n\t\tthis.gridController.getGridBodyRows().forEach((row) => {\n\t\t\tlet id = parseInt(row.getId());\n\t\t\tif (isNaN(id) || !id)\n\t\t\t{\n\t\t\t\tnewRowsCount++;\n\t\t\t\tid = 'n' + newRowsCount;\n\t\t\t}\n\n\t\t\tconst rowValues = row.getEditorValue();\n\t\t\tif (row.isShown() === false)\n\t\t\t{\n\t\t\t\trowValues.UF_DELETE = 'Y';\n\t\t\t}\n\n\t\t\tfor (const fieldName in rowValues)\n\t\t\t{\n\t\t\t\tif (Object.hasOwnProperty.call(rowValues, fieldName))\n\t\t\t\t{\n\t\t\t\t\tresult.append(`fields[DIRECTORY_ITEMS][${id}][${fieldName}]`, rowValues[fieldName]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n}\n"],"names":["GridController","options","grid","BX","Main","gridManager","getInstanceById","gridId","initGrid","getRows","getBodyChild","EventEmitter","subscribe","event","getCompatData","getId","delayToExitStream","setTimeout","initGridRows","bind","bodyRows","getGridBodyRows","length","i","prependRowEditor","forEach","row","edit","newRow","setId","unselect","rows","getSelected","Type","isArray","hide","reset","SettingsForm","gridController","form","app","BitrixVue","createApp","getAppConfig","mount","settingsFormSelector","directoryItems","selectedDirectory","newDirectoryValue","selectedItem","find","item","VALUE","directoryTableName","url","Uri","location","href","setQueryParam","toString","data","directoryName","directoryValue","computed","selectedDirectoryName","isNewDirectory","Loc","getMessage","directoryItemsMap","result","NAME","directoryItemsFull","push","directoryItemsAsMenuItems","map","id","text","onclick","onSelectDirectoryItem","methods","getDirectoryDropdownMenu","bindElement","menuId","menu","MenuManager","getMenuById","getPopupWindow","destroy","create","items","toggleDirectoryDropdown","e","target","toggle","close","reloadDirectory","normalizeName","input","value","translit","addNewRow","PropertyDirectorySettings","signedParameters","settingsForm","initErrorAlert","initSaveButton","removeGridSelectedRows","button","document","querySelector","addEventListener","preventDefault","clearErrors","ajax","runComponentAction","getFormData","mode","then","response","classList","remove","reload","showErrors","errors","Promise","resolve","reject","animateClosingDelay","errorAlert","setText","message","join","renderTo","Alert","color","AlertColor","DANGER","animated","customClass","FormData","append","_instance","newRowsCount","parseInt","isNaN","rowValues","getEditorValue","isShown","UF_DELETE","fieldName","Object","hasOwnProperty","call"],"mappings":";;;;KAGaA,cAAb;CAIC,0BAAYC,OAAZ,EACA;CAAA;CACC,SAAKC,IAAL,GAAYC,EAAE,CAACC,IAAH,CAAQC,WAAR,CAAoBC,eAApB,CAAoCL,OAAO,CAACM,MAA5C,CAAZ;CAEA,SAAKC,QAAL;CACA;;CATF;CAAA;CAAA,sCAYC;CACC,aAAO,KAAKN,IAAL,CAAUO,OAAV,GAAoBC,YAApB,EAAP;CACA;CAdF;CAAA;CAAA,+BAiBC;CAAA;;CACCC,MAAAA,6BAAY,CAACC,SAAb,CAAuB,eAAvB,EAAwC,UAACC,KAAD,EAAW;CAClD,YAAMX,IAAI,GAAGW,KAAK,CAACC,aAAN,GAAsB,CAAtB,CAAb;;CACA,YAAIZ,IAAI,IAAIA,IAAI,CAACa,KAAL,OAAiB,KAAI,CAACb,IAAL,CAAUa,KAAV,EAA7B,EACA;CACC,cAAMC,iBAAiB,GAAG,EAA1B;CACAC,UAAAA,UAAU,CAAC,KAAI,CAACC,YAAL,CAAkBC,IAAlB,CAAuB,KAAvB,CAAD,EAA+BH,iBAA/B,CAAV;CACA;CACD,OAPD;CASA,WAAKE,YAAL;CACA;CA5BF;CAAA;CAAA,mCA+BC;CACC,UAAME,QAAQ,GAAG,KAAKC,eAAL,EAAjB;;CACA,UAAID,QAAQ,CAACE,MAAT,KAAoB,CAAxB,EACA;CACC,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EACA;CACC,eAAKC,gBAAL;CACA;CACD,OAND,MAQA;CACCJ,QAAAA,QAAQ,CAACK,OAAT,CAAiB,UAACC,GAAD,EAAS;CACzBA,UAAAA,GAAG,CAACC,IAAJ;CACA,SAFD;CAGA;CACD;CA9CF;CAAA;CAAA,uCAiDC;CACC,UAAMC,MAAM,GAAG,KAAK1B,IAAL,CAAUsB,gBAAV,EAAf;CACAI,MAAAA,MAAM,CAACC,KAAP,CAAa,EAAb;CACAD,MAAAA,MAAM,CAACE,QAAP;CACA;CArDF;CAAA;CAAA,6CAwDC;CACC,UAAMC,IAAI,GAAG,KAAK7B,IAAL,CAAUO,OAAV,GAAoBuB,WAApB,CAAgC,KAAhC,CAAb;;CACA,UAAIC,cAAI,CAACC,OAAL,CAAaH,IAAb,CAAJ,EACA;CACCA,QAAAA,IAAI,CAACN,OAAL,CAAa,UAACC,GAAD,EAAS;CACrBA,UAAAA,GAAG,CAACS,IAAJ;CACA,SAFD;CAIA,aAAKjC,IAAL,CAAUO,OAAV,GAAoB2B,KAApB;CACA;CACD;CAlEF;CAAA;CAAA;;KCEaC,YAAb;CAAA;CAAA;CAAA,8BAQkBC,cARlB,EAQkDrC,OARlD,EASC;CACC,UAAMsC,IAAI,GAAG,IAAIF,YAAJ,CAAiBC,cAAjB,EAAiCrC,OAAjC,CAAb;CAEAsC,MAAAA,IAAI,CAACC,GAAL,GAAWC,iBAAS,CAACC,SAAV,CAAoBH,IAAI,CAACI,YAAL,EAApB,CAAX;CACAJ,MAAAA,IAAI,CAACC,GAAL,CAASI,KAAT,CAAe3C,OAAO,CAAC4C,oBAAvB;CAEA,aAAON,IAAP;CACA;CAhBF;;CAkBC,wBAAYD,cAAZ,EAA4CrC,OAA5C,EACA;CAAA;CAAA,2DAfoB,IAepB;CACC,SAAKqC,cAAL,GAAsBA,cAAtB;CACA,SAAKQ,cAAL,GAAsBb,cAAI,CAACC,OAAL,CAAajC,OAAO,CAAC6C,cAArB,IAAuC7C,OAAO,CAAC6C,cAA/C,GAAgE,EAAtF;CAEA,SAAKC,iBAAL,GAAyB,KAAKC,iBAA9B;;CACA,QAAI/C,OAAO,CAAC8C,iBAAZ,EACA;CACC,UAAME,YAAY,GAAG,KAAKH,cAAL,CAAoBI,IAApB,CAAyB,UAACC,IAAD;CAAA,eAAUA,IAAI,CAACC,KAAL,KAAenD,OAAO,CAAC8C,iBAAjC;CAAA,OAAzB,CAArB;;CACA,UAAIE,YAAJ,EACA;CACC,aAAKF,iBAAL,GAAyBE,YAAY,CAACG,KAAtC;CACA;CACD;CACD;;CAhCF;CAAA;CAAA,oCAkCiBC,kBAlCjB,EAmCC;CACC,UAAMC,GAAG,GAAG,IAAIC,aAAJ,CAAQC,QAAQ,CAACC,IAAjB,CAAZ;CACAH,MAAAA,GAAG,CAACI,aAAJ,CAAkB,oBAAlB,EAAwCL,kBAAxC;CACAG,MAAAA,QAAQ,CAACC,IAAT,GAAgBH,GAAG,CAACK,QAAJ,EAAhB;CACA;CAvCF;CAAA;CAAA,mCA0CC;CACC,UAAMpB,IAAI,GAAG,IAAb;CAEA,aAAQ,YAAW;CAClB,eAAO;CACNqB,UAAAA,IADM,kBAEN;CACC,mBAAO;CACNC,cAAAA,aAAa,EAAE,IADT;CAENC,cAAAA,cAAc,EAAEvB,IAAI,CAACQ,iBAFf;CAGND,cAAAA,cAAc,EAAEP,IAAI,CAACO;CAHf,aAAP;CAKA,WARK;CAUNiB,UAAAA,QAAQ,EAAE;CACTC,YAAAA,qBADS,mCAET;CACC,kBAAI,KAAKC,cAAT,EACA;CACC,uBAAOC,aAAG,CAACC,UAAJ,CAAe,4DAAf,CAAP;CACA;;CAED,qBAAO,KAAKC,iBAAL,CAAuB,KAAKN,cAA5B,CAAP;CACA,aATQ;CAWTM,YAAAA,iBAXS,+BAYT;CACC,kBAAMC,MAAM,GAAG,EAAf;CAEA,mBAAKvB,cAAL,CAAoBrB,OAApB,CAA4B,UAAC0B,IAAD,EAAU;CACrCkB,gBAAAA,MAAM,CAAClB,IAAI,CAACC,KAAN,CAAN,GAAqBD,IAAI,CAACmB,IAA1B;CACA,eAFD;CAIA,qBAAOD,MAAP;CACA,aApBQ;CAsBTE,YAAAA,kBAtBS,gCAuBT;CACC,kBAAMF,MAAM,GAAG,CACd;CACCC,gBAAAA,IAAI,EAAEJ,aAAG,CAACC,UAAJ,CAAe,4DAAf,CADP;CAECf,gBAAAA,KAAK,EAAEb,IAAI,CAACS;CAFb,eADc,CAAf;CAOAqB,cAAAA,MAAM,CAACG,IAAP,OAAAH,MAAM,iCAAS,KAAKvB,cAAd,EAAN;CAEA,qBAAOuB,MAAP;CACA,aAlCQ;CAoCTI,YAAAA,yBApCS,uCAqCT;CAAA;;CACC,qBAAO,KAAKF,kBAAL,CAAwBG,GAAxB,CAA4B,UAACvB,IAAD,EAAU;CAC5C,uBAAO;CACNwB,kBAAAA,EAAE,EAAExB,IAAI,CAACC,KADH;CAENwB,kBAAAA,IAAI,EAAEzB,IAAI,CAACmB,IAFL;CAGNO,kBAAAA,OAAO,EAAE,KAAI,CAACC,qBAAL,CAA2B3D,IAA3B,CAAgC,KAAhC;CAHH,iBAAP;CAKA,eANM,CAAP;CAOA,aA7CQ;CA+CT8C,YAAAA,cA/CS,4BAgDT;CACC,qBAAO,KAAKH,cAAL,KAAwBvB,IAAI,CAACS,iBAApC;CACA;CAlDQ,WAVJ;CA+DN+B,UAAAA,OAAO,EAAE;CACRC,YAAAA,wBADQ,oCACiBC,WADjB,EAER;CACC,kBAAMC,MAAM,GAAG,iBAAf;CACA,kBAAIC,IAAI,GAAGC,sBAAW,CAACC,WAAZ,CAAwBH,MAAxB,CAAX,CAFD;;CAKC,kBACCC,IAAI,IACDF,WADH,IAEGE,IAAI,CAACG,cAAL,GAAsBL,WAAtB,KAAsCA,WAH1C,EAKA;CACCG,gBAAAA,sBAAW,CAACG,OAAZ,CAAoBJ,IAAI,CAACpE,KAAL,EAApB;CACAoE,gBAAAA,IAAI,GAAG,IAAP;CACA;;CAED,kBAAI,CAACA,IAAD,IAASF,WAAb,EACA;CACCE,gBAAAA,IAAI,GAAGC,sBAAW,CAACI,MAAZ,CAAmB;CACzBb,kBAAAA,EAAE,EAAEO,MADqB;CAEzBO,kBAAAA,KAAK,EAAE,KAAKhB,yBAFa;CAGzBQ,kBAAAA,WAAW,EAAXA;CAHyB,iBAAnB,CAAP;CAKA;;CAED,qBAAOE,IAAP;CACA,aA3BO;CA6BRO,YAAAA,uBA7BQ,mCA6BgBC,CA7BhB,EA8BR;CACC,mBAAKX,wBAAL,CAA8BW,CAAC,CAACC,MAAhC,EAAwCC,MAAxC;CACA,aAhCO;CAkCRf,YAAAA,qBAlCQ,iCAkCca,CAlCd,EAkCiBxC,IAlCjB,EAmCR;CACC,mBAAKW,cAAL,GAAsBX,IAAI,CAACwB,EAA3B;CACA,mBAAKK,wBAAL,GAAgCc,KAAhC;CAEAvD,cAAAA,IAAI,CAACwD,eAAL,CAAqB,KAAKjC,cAA1B;CACA,aAxCO;CA0CRkC,YAAAA,aA1CQ,yBA0CML,CA1CN,EA2CR;CACC,kBAAMM,KAAK,GAAGN,CAAC,CAACC,MAAhB;;CACA,kBAAIK,KAAJ,EACA;CACCA,gBAAAA,KAAK,CAACC,KAAN,GAAc/F,EAAE,CAACgG,QAAH,CACbF,KAAK,CAACC,KADO,EAEb;CACC,iCAAe,GADhB;CAEC,mCAAiB,EAFlB;CAGC,2CAAyB;CAH1B,iBAFa,CAAd;CAQA;CACD,aAxDO;CA0DRE,YAAAA,SA1DQ,uBA2DR;CACC7D,cAAAA,IAAI,CAACD,cAAL,CAAoBd,gBAApB;CACA;CA7DO;CA/DH,SAAP;CA+HA,OAhIM,EAAP;CAiIA;CA9KF;CAAA;CAAA;;KCAa6E,yBAAb;CAOC,qCAAYpG,OAAZ,EACA;CAAA;CACC,SAAKqC,cAAL,GAAsB,IAAItC,cAAJ,CAAmBC,OAAnB,CAAtB;CACA,SAAKqG,gBAAL,GAAwBrG,OAAO,CAACqG,gBAAhC;CACA,SAAKC,YAAL,GAAoBlE,YAAY,CAACK,SAAb,CAAuB,KAAKJ,cAA5B,EAA4CrC,OAA5C,CAApB;CAEA,SAAKuG,cAAL;CACA,SAAKC,cAAL;CACA;;CAfF;CAAA;CAAA,6CAkBC;CACC,WAAKnE,cAAL,CAAoBoE,sBAApB;CACA;CApBF;CAAA;CAAA,qCAuBC;CAAA;;CACC,UAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,uBAAvB,CAAf;;CACA,UAAIF,MAAJ,EACA;CACCA,QAAAA,MAAM,CAACG,gBAAP,CAAwB,OAAxB;CAAA,yFAAiC,iBAAOnB,CAAP;CAAA;CAAA;CAAA;CAAA;CAChCA,oBAAAA,CAAC,CAACoB,cAAF;CADgC;CAAA,2BAG1B,KAAI,CAACC,WAAL,EAH0B;;CAAA;CAKhCC,oBAAAA,cAAI,CACFC,kBADF,CACqB,gDADrB,EACuE,MADvE,EAC+E;CAC7EtD,sBAAAA,IAAI,EAAE,KAAI,CAACuD,WAAL,EADuE;CAE7EC,sBAAAA,IAAI,EAAE,OAFuE;CAG7Ed,sBAAAA,gBAAgB,EAAE,KAAI,CAACA;CAHsD,qBAD/E,EAMEe,IANF,CAMO,UAACC,QAAD,EAAc;CACnBX,sBAAAA,MAAM,CAACY,SAAP,CAAiBC,MAAjB,CAAwB,aAAxB;CAEAhE,sBAAAA,QAAQ,CAACiE,MAAT;CACA,qBAVF,WAWQ,UAACH,QAAD,EAAc;CACpBX,sBAAAA,MAAM,CAACY,SAAP,CAAiBC,MAAjB,CAAwB,aAAxB;;CAEA,sBAAA,KAAI,CAACE,UAAL,CAAgBJ,QAAQ,CAACK,MAAzB;CACA,qBAfF;;CALgC;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA,WAAjC;;CAAA;CAAA;CAAA;CAAA;CAuBA;CACD;CAnDF;CAAA;CAAA,kCAsDC;CAAA;;CACC,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;CACvC,YAAMC,mBAAmB,GAAG,GAA5B;;CAEA,QAAA,MAAI,CAACC,UAAL,CAAgB7F,IAAhB;;CAEAlB,QAAAA,UAAU,CAAC4G,OAAD,EAAUE,mBAAV,CAAV;CACA,OANM,CAAP;CAOA;CA9DF;CAAA;CAAA,+BAgEYJ,MAhEZ,EAiEC;CACC,WAAKK,UAAL,CAAgBC,OAAhB,CAAwBN,MAAM,CAACjD,GAAP,CAAW,UAACnD,CAAD;CAAA,eAAOA,CAAC,CAAC2G,OAAT;CAAA,OAAX,EAA6BC,IAA7B,CAAkC,MAAlC,CAAxB;CACA,WAAKH,UAAL,CAAgBI,QAAhB,CAAyBxB,QAAQ,CAACC,aAAT,CAAuB,kBAAvB,CAAzB;CACA;CApEF;CAAA;CAAA,qCAuEC;CACC,WAAKmB,UAAL,GAAkB,IAAIK,eAAJ,CAAU;CAC3BC,QAAAA,KAAK,EAAEC,oBAAU,CAACC,MADS;CAE3BC,QAAAA,QAAQ,EAAE,IAFiB;CAG3BC,QAAAA,WAAW,EAAE;CAHc,OAAV,CAAlB;CAKA;CA7EF;CAAA;CAAA,kCAgFC;CACC,UAAMrE,MAAM,GAAG,IAAIsE,QAAJ,EAAf;CAEAtE,MAAAA,MAAM,CAACuE,MAAP,CAAc,wBAAd,EAAwC,KAAKrC,YAAL,CAAkB/D,GAAlB,CAAsBqG,SAAtB,CAAgCjF,IAAhC,CAAqCC,aAArC,IAAsD,EAA9F;CACAQ,MAAAA,MAAM,CAACuE,MAAP,CAAc,8BAAd,EAA8C,KAAKrC,YAAL,CAAkB/D,GAAlB,CAAsBqG,SAAtB,CAAgCjF,IAAhC,CAAqCE,cAArC,IAAuD,EAArG;CAEA,UAAIgF,YAAY,GAAG,CAAnB;CACA,WAAKxG,cAAL,CAAoBjB,eAApB,GAAsCI,OAAtC,CAA8C,UAACC,GAAD,EAAS;CACtD,YAAIiD,EAAE,GAAGoE,QAAQ,CAACrH,GAAG,CAACX,KAAJ,EAAD,CAAjB;;CACA,YAAIiI,KAAK,CAACrE,EAAD,CAAL,IAAa,CAACA,EAAlB,EACA;CACCmE,UAAAA,YAAY;CACZnE,UAAAA,EAAE,GAAG,MAAMmE,YAAX;CACA;;CAED,YAAMG,SAAS,GAAGvH,GAAG,CAACwH,cAAJ,EAAlB;;CACA,YAAIxH,GAAG,CAACyH,OAAJ,OAAkB,KAAtB,EACA;CACCF,UAAAA,SAAS,CAACG,SAAV,GAAsB,GAAtB;CACA;;CAED,aAAK,IAAMC,SAAX,IAAwBJ,SAAxB,EACA;CACC,cAAIK,MAAM,CAACC,cAAP,CAAsBC,IAAtB,CAA2BP,SAA3B,EAAsCI,SAAtC,CAAJ,EACA;CACChF,YAAAA,MAAM,CAACuE,MAAP,mCAAyCjE,EAAzC,eAAgD0E,SAAhD,QAA8DJ,SAAS,CAACI,SAAD,CAAvE;CACA;CACD;CACD,OArBD;CAuBA,aAAOhF,MAAP;CACA;CA/GF;CAAA;CAAA;;;;;;;;"}